name: "hello-world"
principal: "hello-world-principal"
zookeeper: master.mesos:2181
api-port: {{PORT0}}
replacement-failure-policy:
  permanent-failure-timeout-ms: 10
  min-replace-delay-ms: 10
pods:
  meta-data:
    placement: "avoid-type: meta-data"
    count: {{METADATA_COUNT}}
    resource-sets:
      - id: meta-data-resources
        resources:
          - name: cpus
            value: {{METADATA_CPUS}}
            env-key: "CPUS"
          - name: mem
            value: {{METADATA_MEM}}
            env-key: "MEM"
        volumes:
          - path: "meta-data-container-path"
            type: ROOT
            size: {{METADATA_DISK}}
    tasks:
      meta-data-task:
        goal: RUNNING
        cmd: "echo $TASK_NAME >> $TASK_NAME$CONTAINER_PATH_SUFFIX/output && sleep $SLEEP_DURATION"
        resource-set: meta-data-resources
        env:
          TASK_NAME: "meta-data"
          CONTAINER_PATH_SUFFIX: "-container-path"
          SLEEP_DURATION: {{SLEEP_DURATION}}
        health-checks:
          check-up:
            cmd: "stat $TASK_NAME$CONTAINER_PATH_SUFFIX/output"
            interval: 5
            grace-period: 30
            max-consecutive-failures: 3
            delay: 0
            timeout: 10

  hello-world:
    placement: "avoid-type: hello-world"
    count: {{DATA_COUNT}}
    resource-sets:
      - id: hello-world-resources
        resources:
          - name: cpus
            value: {{DATA_CPUS}}
            env-key: "CPUS"
          - name: mem
            value: {{DATA_MEM}}
            env-key: "MEM"
        volumes:
          - path: "hello-world-container-path"
            type: ROOT
            size: {{DATA_DISK}}
    tasks:
      hello-world-task:
        goal: RUNNING
        cmd: "echo $TASK_NAME >> $TASK_NAME$CONTAINER_PATH_SUFFIX/output && sleep $SLEEP_DURATION"
        resource-set: hello-world-resources
        env:
          TASK_NAME: "hello-world"
          CONTAINER_PATH_SUFFIX: "-container-path"
          SLEEP_DURATION: {{SLEEP_DURATION}}
        health-checks:
          check-up:
            cmd: "stat $TASK_NAME$CONTAINER_PATH_SUFFIX/output"
            interval: 5
            grace-period: 30
            max-consecutive-failures: 3
            delay: 0
            timeout: 10
